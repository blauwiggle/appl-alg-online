<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>appl-alg-online</title>
    <link rel="stylesheet" href="style/codemirror.css">
    <link rel="stylesheet" href="style/main.css">
  </head>
  <body>


    <div class="toolbar">
      <h1>appl-alg-online</h1>
      <button id="run" class="btn">run</button>
    </div>


    <textarea id="editor" class="editor">main() = primes(50)
#------------------

primes(N) = _primes(N, 2, [])

_primes(N, t, p_list) = if t>N then p_list
                        else
                        	if _isPrime(t)=true then
                        		_primes(N, t+1, t->p_list[length(p_list)])
                        	else
                        		_primes(N, t+1, p_list)
                        	endif
                        endif

_isPrime(t) = __isPrime(t, 2)

__isPrime(t, x) = if x^2 > t then true
				  else if t%x = 0 then false
				       else
				          __isPrime(t, x+1)
				       endif
				  endif
</textarea>

    <p id="output" class="output"></p>

    <script src="src/codemirror.js"></script>
    <script src="src/simple-mode.js"></script>
    <script src="src/appl-alg-mode.js"></script>
    <script src="src/gwt.js"></script>
    <script src="src/appl-alg.js"></script>
    <script>

      (function () {
        'use strict';

        var editorEl = document.getElementById('editor');
        var editor = CodeMirror.fromTextArea(editorEl, {
          lineNumbers: true,
          mode: 'appl-alg-mode'
        });
        var outputEl = document.getElementById('output');

        document.getElementById('run').addEventListener('click', function () {
          outputEl.innerText = applAlgExecute(editor.getValue());
        });

      }());
    </script>

  </body>
</html>